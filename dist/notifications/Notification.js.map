{"version":3,"sources":["notifications/Notification.ts"],"names":[],"mappings":"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","file":"Notification.js","sourcesContent":["/**\n * Shows notifcations and hints to the user\n */\n\ndeclare global {\n  interface Window {\n    vtta: VTTA;\n  }\n}\n\nconst MARGIN = 10;\n\ninterface NotificationsOptionsHide {\n  selector: JQuery;\n  event: string;\n}\n\ninterface NotificationOptions {\n  width?: number;\n  height?: number;\n  element?: JQuery;\n  align?: string;\n  buttons?: string[];\n  hide?: NotificationsOptionsHide;\n}\n\ninterface Notification {\n  hide?: () => void;\n  show?: (message: string, timeout?: number) => void;\n}\n\ninterface Hint {\n  hide?: () => void;\n  show?: (message: string, options?: NotificationOptions) => void;\n}\n\ninterface VTTA {\n  notification: Notification;\n  hint: Hint;\n}\n\nconst registerNotifications = (): void => {\n  // register the notification global object\n\n  if ($(\"#tips-notifications\").length === 0) {\n    $(\"body\").append(`<div id=\"tips-notifications\" class=\"app\"></div>`);\n  }\n  if ($(\"#tips-hints\").length === 0) {\n    $(\"body\").append(`<div id=\"tips-hints\"></div>`);\n  }\n\n  window.vtta =\n    <VTTA>window.vtta ||\n    <VTTA>{\n      notification: {\n        clear: () => {\n          $(\"#tips-notifications div\").fadeOut(200, () => {\n            $(\"#tips-notifications\").empty();\n          });\n        },\n        show: (message, timeout = 4000) => {\n          //$(\"#tips-notifications\").css(\"left\", $(\"#players\").css(\"left\"));\n          // prettier-ignore\n          //$(\"#tips-notifications\").css(\"bottom\", $(\"#players\").height() + (2 * MARGIN));\n\n          let note = $(\"#tips-notifications\").append(message);\n          $(note).fadeIn(200);\n\n          if (timeout)\n            setTimeout(() => {\n              $(note).fadeOut(200, () => {\n                $(note).remove();\n              });\n            }, timeout);\n          else\n            $(note).append('<p style=\"text-align: center; color: #7e7e7e; margin: 0px;\"><small>Click to close</small>');\n\n          $(note).on(\"click\", () => {\n            $(note).fadeOut(200, () => {\n              $(note).remove();\n            });\n          });\n        },\n      },\n      hint: {\n        clear: () => {\n          $(\"#tips-hints div\").hide(200, () => {\n            $(\"#tips-hints\").empty();\n          });\n        },\n        show: (message, options: NotificationOptions = {}) => {\n          return new Promise((resolve) => {\n            $(\"#tips-hints\").css(\"width\", options.width ? options.width : 300);\n\n            // construct the note\n            let note = $(`<div style=\"display: none\"></div>`);\n            $(note).append(message);\n            $(note).append('<div class=\"buttons\"></div>');\n            $(\"#tips-hints\").append(note);\n            $(note).fadeIn(200);\n\n            if (!options.align) options.align = options.element ? \"RIGHT\" : \"CENTER\";\n\n            let anchor = {\n              width: 0,\n              height: 0,\n              top: Math.round(window.innerHeight / 2),\n              left: Math.round(window.innerWidth / 2),\n            };\n\n            if (options.element) {\n              anchor = Object.assign(\n                { width: $(options.element).width(), height: $(options.element).height() },\n                $(options.element).offset()\n              );\n            }\n            const noteInfo = Object.assign(\n              { width: $(\"#tips-hints\").width(), height: $(\"#tips-hints\").height() },\n              $(\"#tips-hints\").position()\n            );\n\n            switch (options.align) {\n              case \"RIGHT\":\n                $(\"#tips-hints\").css(\"top\", anchor.top);\n                $(\"#tips-hints\").css(\"left\", anchor.left + anchor.width + MARGIN);\n                break;\n              case \"LEFT\":\n                $(\"#tips-hints\").css(\"top\", anchor.top);\n                $(\"#tips-hints\").css(\"left\", anchor.left - noteInfo.width - MARGIN);\n                break;\n              case \"TOP\":\n                $(\"#tips-hints\").css(\"top\", anchor.top - noteInfo.height - MARGIN);\n                $(\"#tips-hints\").css(\"left\", anchor.left);\n                break;\n              case \"BOTTOM\":\n                $(\"#tips-hints\").css(\"top\", anchor.top + anchor.height + MARGIN);\n                $(\"#tips-hints\").css(\"left\", anchor.left);\n                break;\n\n              default:\n                // eslint-disable-next-line no-mixed-operators\n                $(\"#tips-hints\").css(\"top\", anchor.top - Math.round(noteInfo.height / 2));\n                // eslint-disable-next-line no-mixed-operators\n                $(\"#tips-hints\").css(\"left\", anchor.left - Math.round(noteInfo.width / 2));\n            }\n\n            if (options.buttons) {\n              for (let name of options.buttons) {\n                let btn = $(\"<button>\" + name + \"</button>\");\n                $(\"div.buttons\", note).append(btn);\n                $(btn).on(\"click\", () => {\n                  $(note).fadeOut(100, () => {\n                    $(note).remove();\n                    resolve(name);\n                  });\n                });\n              }\n            }\n            if (options.hide) {\n              $(options.hide.selector).on(options.hide.event, () => {\n                $(note).fadeOut(100, () => {\n                  $(note).remove();\n                  resolve(true);\n                });\n              });\n            }\n          });\n        },\n      },\n    };\n};\n\nexport default registerNotifications;\n"]}